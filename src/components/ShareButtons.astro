---
interface Props {
  title: string;
  url: string;
}

const { title, url } = Astro.props;
const fixedUrl = url.replace(/^\/blog\/blog\//, '/blog/');
const fullUrl = `https://lifeloop.com.ar${fixedUrl}`;
const encodedTitle = encodeURIComponent(title);
const encodedUrl = encodeURIComponent(fullUrl);
---

<div class="flex items-center gap-3">
  <span class="text-[11px] font-inter font-500 uppercase tracking-widest text-white/30">Compartir</span>
  <div class="flex gap-2">
    <a
      href={`https://wa.me/?text=${encodedTitle}%20${encodedUrl}`}
      target="_blank"
      rel="noopener"
      class="w-8 h-8 flex items-center justify-center rounded bg-white/5 hover:bg-ll-gold/20 text-white/40 hover:text-ll-gold transition-all text-xs"
      aria-label="Compartir en WhatsApp"
    >WA</a>
    <a
      href={`https://twitter.com/intent/tweet?text=${encodedTitle}&url=${encodedUrl}`}
      target="_blank"
      rel="noopener"
      class="w-8 h-8 flex items-center justify-center rounded bg-white/5 hover:bg-ll-gold/20 text-white/40 hover:text-ll-gold transition-all text-xs"
      aria-label="Compartir en X"
    >X</a>
    <a
      href={`https://linkedin.com/shareArticle?mini=true&url=${encodedUrl}&title=${encodedTitle}`}
      target="_blank"
      rel="noopener"
      class="w-8 h-8 flex items-center justify-center rounded bg-white/5 hover:bg-ll-gold/20 text-white/40 hover:text-ll-gold transition-all text-xs"
      aria-label="Compartir en LinkedIn"
    >Li</a>
    <button
      id="copy-link"
      data-url={fullUrl}
      class="w-8 h-8 flex items-center justify-center rounded bg-white/5 hover:bg-ll-gold/20 text-white/40 hover:text-ll-gold transition-all text-xs"
      aria-label="Copiar enlace"
    >ðŸ”—</button>
  </div>
</div>

<script>
  document.getElementById('copy-link')?.addEventListener('click', async (e) => {
    const btn = e.currentTarget as HTMLButtonElement;
    const url = btn.dataset.url || '';
    await navigator.clipboard.writeText(url);
    btn.textContent = 'âœ“';
    setTimeout(() => btn.textContent = 'ðŸ”—', 2000);
  });
</script>
